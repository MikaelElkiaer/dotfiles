#!/usr/bin/env bash

KUBECONFIG_LINK="/tmp/TMUX_${1}_KUBECONFIG"
if [ -e "$KUBECONFIG_LINK" ]; then
  export KUBECONFIG="$KUBECONFIG_LINK"
  RESULT=""
  if CONTEXT="$(kubectl config current-context)"; then
    RESULT="#[fg=colour13] ó±ƒ¾ $CONTEXT"
  fi
  if NAMESPACE="$(
    kubectl config view --minify --output jsonpath='{..namespace}'
    echo
  )"; then
    RESULT="$RESULT(${NAMESPACE:-default})"
  fi
  if [ -n "$RESULT" ]; then
    echo "$RESULT#[fg=colour8]"
  fi
fi
